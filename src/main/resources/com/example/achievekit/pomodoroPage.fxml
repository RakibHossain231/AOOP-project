<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane stylesheets="@pomodoroCSS.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.achievekit.PomodoroController">

    <!-- ===== Sidebar (unchanged) ===== -->
    <left>
        <!-- ScrollPane-à¦•à§‡ transparent à¦°à¦¾à¦–à¦¾à¦° à¦œà¦¨à§à¦¯ styleClass="sidebar-scroll" -->
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" prefWidth="280.0" styleClass="sidebar-scroll" vbarPolicy="ALWAYS">
            <content>
                <!-- à¦¤à§‹à¦®à¦¾à¦° à¦†à¦—à§‡à¦° à¦•à¦¾à¦²à¦¾à¦°/à¦—à§à¦°à§‡à¦¡à¦¿à§Ÿà§‡à¦¨à§à¦Ÿ à¦à¦‡ VBox-à¦à¦‡ à¦¥à¦¾à¦•à¦¬à§‡ -->
                <VBox prefWidth="280.0" styleClass="sidebar">
                    <children>

                        <!-- Sidebar Header -->
                        <VBox styleClass="sidebar-header">
                            <children>
                                <HBox alignment="CENTER_LEFT" spacing="12.0">
                                    <children>
                                        <Label styleClass="logo-icon" text="ðŸ“š" />
                                        <VBox>
                                            <children>
                                                <Label styleClass="logo-text" text="AchieveKIT" />
                                                <Label styleClass="logo-subtitle" text="Productivity Hub" />
                                            </children>
                                        </VBox>
                                    </children>
                                    <padding>
                                        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                                    </padding>
                                </HBox>
                            </children>
                        </VBox>

                        <!-- User Profile Section -->
                        <VBox fx:id="profileBox" styleClass="user-profile">
                            <children>
                                <HBox alignment="CENTER_LEFT" spacing="12.0">
                                    <children>
                                        <!-- à¦ªà§à¦°à¦¥à¦® à¦…à¦•à§à¦·à¦°à§‡à¦° à¦…à§à¦¯à¦¾à¦­à¦¾à¦Ÿà¦¾à¦° -->
                                        <Label fx:id="avatarLabel" styleClass="user-avatar" text="U" />
                                        <VBox>
                                            <children>
                                                <Label fx:id="sidebarName" styleClass="user-name" text="John Student" />
                                                <Label fx:id="sidebarSubtext" styleClass="user-status" text="Premium Member" />
                                            </children>
                                        </VBox>
                                    </children>
                                    <padding>
                                        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                                    </padding>
                                </HBox>
                            </children>
                        </VBox>

                        <!-- Main Navigation Menu -->
                        <VBox styleClass="nav-menu">
                            <children>
                                <Button fx:id="dashboardBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0" mnemonicParsing="false" onAction="#showDashboard" prefWidth="240.0" styleClass="nav-item,nav-item-active" text="ðŸ  Dashboard" />
                                <Button fx:id="pomodoroBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0" mnemonicParsing="false" onAction="#showPomodoro" prefWidth="240.0" styleClass="nav-item" text="ðŸ… Pomodoro Timer" />
                                <Button fx:id="tasksBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0" mnemonicParsing="false" onAction="#showTasks" prefWidth="240.0" styleClass="nav-item" text="âœ… Task Manager" />
                                <Button fx:id="expensesBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0" mnemonicParsing="false" onAction="#showExpenses" prefWidth="240.0" styleClass="nav-item" text="ðŸ’° Expense Tracker" />
                                <Button fx:id="chatBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0" mnemonicParsing="false" onAction="#showChat" prefWidth="240.0" styleClass="nav-item" text="ðŸ’¬ Study Chat" />

                                <!-- Separator -->
                                <Separator styleClass="nav-separator">
                                    <VBox.margin>
                                        <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
                                    </VBox.margin>
                                </Separator>

                                <!--                                &lt;!&ndash; Secondary Menu &ndash;&gt;-->
                                <!--                                <Button fx:id="analyticsBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0"-->
                                <!--                                        mnemonicParsing="false" onAction="#showAnalytics" prefWidth="240.0"-->
                                <!--                                        styleClass="nav-item" text="ðŸ“Š Analytics"/>-->
                                <!--                                <Button fx:id="settingsBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0"-->
                                <!--                                        mnemonicParsing="false" onAction="#showSettings" prefWidth="240.0" styleClass="nav-item"-->
                                <!--                                        text="âš™ï¸ Settings"/>-->
                                <!--                                <Button fx:id="tipsBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0" mnemonicParsing="false"-->
                                <!--                                        onAction="#showTips" prefWidth="240.0" styleClass="nav-item" text="ðŸ’¡ Study Tips"/>-->
                            </children>
                            <padding>
                                <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
                            </padding>
                        </VBox>

                        <!-- à¦«à¦¾à¦à¦•à¦¾ à¦¸à§à¦ªà§‡à¦¸: à¦œà¦¾à§Ÿà¦—à¦¾ à¦¥à¦¾à¦•à¦²à§‡ à¦«à§à¦Ÿà¦¾à¦° à¦¨à¦¿à¦šà§‡ à¦¥à¦¾à¦•à¦¬à§‡ -->
                        <Region VBox.vgrow="ALWAYS" />

                        <!-- Sidebar Footer -->
                        <VBox styleClass="sidebar-footer">
                            <children>
                                <Button fx:id="logoutBtn" alignment="BASELINE_LEFT" graphicTextGap="12.0" mnemonicParsing="false" onAction="#logout" prefWidth="240.0" styleClass="nav-item" text="ðŸšª Logout" />
                            </children>
                            <padding>
                                <Insets bottom="20.0" left="20.0" right="20.0" top="10.0" />
                            </padding>
                        </VBox>

                    </children>
                </VBox>
            </content>
        </ScrollPane>
    </left>

    <!-- ===== Main Content ===== -->
    <center>
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" prefWidth="280" styleClass="sidebar-scroll" vbarPolicy="ALWAYS">
            <VBox alignment="TOP_CENTER" spacing="25" styleClass="main-content">

                <!-- Header -->
                <HBox alignment="CENTER_LEFT" styleClass="top-header">
                    <children>
                        <VBox HBox.hgrow="ALWAYS">
                            <children>
                                <Label fx:id="pageTitle" styleClass="page-title" text="Pomodoro Timer" />
                                <Label styleClass="page-subtitle" text="Focus with timed study sessions." />
                            </children>
                        </VBox>
                        <!--                        <HBox alignment="CENTER_RIGHT" spacing="10">-->
                        <!--                            <children>-->
                        <!--                                <Button fx:id="settingsBtn2" onAction="#openPomodoroSettings" text="âš™ï¸" styleClass="header-btn"/>-->
                        <!--                                <Button fx:id="helpBtn" onAction="#showPomodoroHelp" text="â“" styleClass="header-btn"/>-->
                        <!--                            </children>-->
                        <!--                        </HBox>-->
                    </children>
                    <padding>
                        <Insets bottom="20" left="30" right="30" top="20" />
                    </padding>
                </HBox>

                <!-- Focus Card -->
                <VBox alignment="CENTER" spacing="15" styleClass="pomodoro-card">
                    <children>

                        <!-- Task Selection Section -->
                        <HBox alignment="TOP_LEFT" spacing="20" styleClass="task-bar">
                            <children>

                                <!-- Left: Single Task -->
                                <VBox fx:id="selectTaskSection" alignment="TOP_LEFT" spacing="5">
                                    <children>
                                        <Label styleClass="task-label" text="ðŸŽ¯ Single Task Selection:" />
                                        <ComboBox fx:id="taskSelector" prefWidth="260" promptText="Select a task..." styleClass="task-combobox" />
                                    </children>
                                </VBox>

                                <Separator orientation="VERTICAL" prefHeight="90" />

                                <!-- Right: Group Task Mode -->
                                <VBox fx:id="groupTaskSection" alignment="TOP_LEFT" spacing="8">
                                    <children>
                                        <!-- Checkbox to enable group mode -->
                                        <Label styleClass="task-label" text="ðŸŽ¯ Multiple Task Selection:" />

                                        <CheckBox fx:id="groupTaskModeCheckbox"
                                                  style="-fx-font-weight: bold; -fx-text-fill: #ffcc00;"
                                                  text="Group Task Mode [Press control when Selecting]" />

                                        <!-- Multi-select task list -->
                                        <ListView fx:id="groupTaskListView"
                                                  prefHeight="160" prefWidth="240"
                                                  style="-fx-background-color: #1a1a1a;
                                 -fx-border-color: #ffcc00;
                                 -fx-border-radius: 8;
                                 -fx-background-radius: 8;
                                 -fx-padding: 5;"
                                                  visible="false" VBox.vgrow="ALWAYS" />

                                        <!-- Label to show selected tasks -->
                                        <Label fx:id="selectedTasksLabel"
                                               maxWidth="240"
                                               style="-fx-text-fill: #fbbf24; -fx-font-size: 12px;"
                                               visible="false" wrapText="true" />

                                        <!-- Confirm Button -->
                                        <Button fx:id="confirmGroupBtn"
                                                onAction="#handleGroupStart"
                                                style="-fx-background-color: #ffcc00;
                               -fx-text-fill: #000000;
                               -fx-font-weight: bold;
                               -fx-background-radius: 6;
                               -fx-padding: 6 12;"
                                                text="âœ… Confirm &amp; Start"
                                                visible="false" />
                                    </children>
                                </VBox>

                            </children>
                        </HBox>
                        <!-- Current Task -->
                        <VBox alignment="CENTER" spacing="5" styleClass="current-task-box">
                            <children>
                                <Label styleClass="current-task-header" text="Now Working On:" />
                                <Label fx:id="currentTaskLabel" styleClass="current-task-name" text="No task selected" />
                            </children>
                        </VBox>

                        <!-- Timer -->
                        <VBox alignment="CENTER" spacing="6">
                            <children>
                                <Label fx:id="sessionTypeLabel" styleClass="session-type" text="Focus Session" />
                                <Label fx:id="sessionNumberLabel" styleClass="session-number" text="Session 1 of 4" />
                                <Label fx:id="timerLabel" styleClass="timer-text" text="25:00" />
                                <ProgressBar fx:id="timerProgress" prefWidth="340" progress="0.0" styleClass="timer-progress" />
                            </children>
                        </VBox>

                        <!-- Timer Controls -->
                        <HBox alignment="CENTER" spacing="15" styleClass="timer-controls">
                            <children>
                                <Button fx:id="startPauseBtn" onAction="#toggleTimer" styleClass="main-btn,start-btn" text="â–¶ Start" />
                                <Button fx:id="stopBtn" onAction="#stopTimer" styleClass="main-btn,stop-btn" text="â¹ Stop" />
                                <Button fx:id="resetBtn" onAction="#resetTimer" styleClass="main-btn,reset-btn" text="ðŸ”„ Reset" />
                                <Button fx:id="skipSessionBtn" onAction="#skipSession" styleClass="main-btn,skip-btn" text="â­ Skip" />
                            </children>
                        </HBox>

                    </children>
                    <padding>
                        <Insets bottom="25" left="30" right="30" top="20" />
                    </padding>
                </VBox>

                <!-- Quick Settings -->
                <HBox alignment="CENTER" spacing="25" styleClass="quick-settings">
                    <children>
                        <VBox alignment="CENTER" spacing="5">
                            <children>
                                <Label styleClass="setting-label" text="Focus Duration" />
                                <HBox alignment="CENTER" spacing="10">
                                    <children>
                                        <Button onAction="#decreaseFocusTime" styleClass="time-adjust-btn" text="âˆ’" />
                                        <Label fx:id="focusDurationLabel" styleClass="time-display" text="25 min" />
                                        <Button onAction="#increaseFocusTime" styleClass="time-adjust-btn" text="+" />
                                    </children>
                                </HBox>
                            </children>
                        </VBox>

                        <VBox alignment="CENTER" spacing="5">
                            <children>
                                <Label styleClass="setting-label" text="Short Break" />
                                <HBox alignment="CENTER" spacing="10">
                                    <children>
                                        <Button onAction="#decreaseShortBreak" styleClass="time-adjust-btn" text="âˆ’" />
                                        <Label fx:id="shortBreakLabel" styleClass="time-display" text="5 min" />
                                        <Button onAction="#increaseShortBreak" styleClass="time-adjust-btn" text="+" />
                                    </children>
                                </HBox>
                            </children>
                        </VBox>

                        <VBox alignment="CENTER" spacing="5">
                            <children>
                                <Label styleClass="setting-label" text="Long Break" />
                                <HBox alignment="CENTER" spacing="10">
                                    <children>
                                        <Button onAction="#decreaseLongBreak" styleClass="time-adjust-btn" text="âˆ’" />
                                        <Label fx:id="longBreakLabel" styleClass="time-display" text="15 min" />
                                        <Button onAction="#increaseLongBreak" styleClass="time-adjust-btn" text="+" />
                                    </children>
                                </HBox>
                            </children>
                        </VBox>

                        <VBox alignment="CENTER" spacing="5">
                            <children>
                                <Label styleClass="setting-label" text="Auto Start" />
                                <CheckBox fx:id="autoStartCheckbox" onAction="#toggleAutoStart" styleClass="auto-start-checkbox" text="Enabled" />
                            </children>
                        </VBox>
                    </children>
                </HBox>

                <!-- History -->
                <VBox spacing="10" styleClass="history-section">
                    <children>
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <children>
                                <Label styleClass="section-title" text="Today's Sessions" />
                                <Region HBox.hgrow="ALWAYS" />
                                <Button fx:id="exportBtn" onAction="#exportSessions" styleClass="small-btn" text="ðŸ“Š Export" />
                                <Button fx:id="clearHistoryBtn" onAction="#clearTodayHistory" styleClass="small-btn" text="ðŸ—‘ Clear" />
                                <Button fx:id="refreshHistoryBtn" onAction="#handleRefreshSessions" styleClass="small-btn" text="ðŸ”„ Refresh" />

                            </children>
                        </HBox>
                        <TableView fx:id="sessionHistoryTable" prefHeight="200" styleClass="session-table">
                            <columns>
                                <TableColumn fx:id="sessionTypeColumn" prefWidth="120" text="Type" />
                                <TableColumn fx:id="startTimeColumn" prefWidth="120" text="Start Time" />
                                <TableColumn fx:id="endTimeColumn" prefWidth="120" text="End Time" />
                                <TableColumn fx:id="durationColumn" prefWidth="100" text="Duration" />
                                <TableColumn fx:id="statusColumn" prefWidth="100" text="Status" />
                            </columns>
                        </TableView>
                    </children>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>

    <styleClass>
        <String fx:value="main-window" />
    </styleClass>
</BorderPane>
